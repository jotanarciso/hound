# ðŸ¦® Cirne.co - VS Code Extension Project

## Overview
Cirne.co is a VS Code extension that generates beautiful code snippets as PNG images. The extension creates visually appealing screenshots of selected code with syntax highlighting, customizable themes, and professional styling.

## Project Structure
```
hound/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ extension.ts          # Main extension logic and commands
â”‚   â”œâ”€â”€ html-generator.ts     # HTML/CSS generation for snippets
â”‚   â”œâ”€â”€ themes.json          # Theme mapping file
â”‚   â””â”€â”€ themes/              # Individual theme definitions
â”‚       â”œâ”€â”€ dark-mode.json
â”‚       â”œâ”€â”€ light-mode.json
â”‚       â”œâ”€â”€ dracula.json
â”‚       â”œâ”€â”€ github-dark.json
â”‚       â”œâ”€â”€ one-dark.json
â”‚       â”œâ”€â”€ monokai.json
â”‚       â””â”€â”€ liquid-apple.json
â”œâ”€â”€ package.json             # Extension manifest and dependencies
â”œâ”€â”€ .vscode/                 # VS Code configuration
â”‚   â”œâ”€â”€ launch.json
â”‚   â””â”€â”€ tasks.json
â”œâ”€â”€ CIRNECO_CONFIG.md        # User configuration documentation
â””â”€â”€ out/                     # Compiled output (auto-generated)
```

## Key Features

### 1. Dual Command System
- **"Cirne.co: Generate with default theme"** - Uses dracula theme by default
- **"Cirne.co: Generate with theme picker"** - Allows theme selection

### 2. Theme System
- **Built-in themes**: dark-mode, light-mode, dracula, github-dark, one-dark, monokai, liquid-apple
- **Custom themes**: Users can define custom themes in `.cirneco.json`
- **Theme merging**: Custom themes can extend/override built-in themes
- **Dynamic loading**: Themes loaded from individual JSON files

### 3. Configuration System
- **Auto-creation**: `.cirneco.json` file created automatically in user's workspace
- **Global options**: Control visibility of title, language badge, window controls
- **Theme persistence**: Selected themes are saved for future use

### 4. Visual Features
- **Syntax highlighting**: Powered by Prism.js with language detection
- **Window styling**: macOS-style window with controls, title bar, and language badge
- **Premium design**: Glassmorphism effects, gradients, shadows
- **Responsive layout**: Dynamic height adjustment for code length
- **Brand integration**: "Generated by Cirne.co" watermark

## Technical Architecture

### Core Components

#### 1. Extension Activation (`src/extension.ts`)
- Registers two main commands
- Handles VS Code integration
- Manages theme loading and configuration
- Controls Puppeteer screenshot generation

#### 2. HTML Generation (`src/html-generator.ts`)
- Creates HTML templates with embedded CSS
- Applies theme colors and syntax highlighting
- Handles conditional rendering based on options
- Integrates Prism.js for code highlighting

#### 3. Theme Management
- **Theme Loading**: Reads from `src/themes.json` mapping file
- **Custom Themes**: Merges user-defined themes with built-in ones
- **Options Processing**: Applies global and theme-specific options

### Key Functions

#### `generateSnippetImage(code, language)`
- Simple image generation using default styling
- Used by the first command for reliable operation

#### `generateSnippetImageWithTheme(code, language, themeName, filename)`
- Advanced image generation with theme support
- Handles custom themes and configuration merging
- Used by the second command

#### `createHTMLWithFilename(code, language, theme, filename)`
- Generates HTML with syntax highlighting
- Applies theme styling and conditional elements
- Returns complete HTML document for screenshot

#### `ensureCirnecoConfig(themeName)`
- Creates/updates `.cirneco.json` configuration file
- Sets default options and saves selected theme
- Maintains user preferences across sessions

#### `mergeThemes(baseTheme, customTheme)`
- Recursively merges theme properties
- Allows partial theme customization
- Preserves base theme structure

### Configuration Schema

#### `.cirneco.json` Structure
```json
{
  "theme": "dracula",
  "options": {
    "showTitle": true,
    "showLanguageBadge": true,
    "showWindowControls": true
  },
  "customThemes": {
    "my-theme": {
      "name": "My Custom Theme",
      "colors": { /* color definitions */ },
      "syntax": { /* syntax highlighting colors */ },
      "options": { /* theme-specific options */ }
    }
  }
}
```

#### Theme Structure
```json
{
  "name": "Theme Name",
  "description": "Theme description",
  "colors": {
    "background": "#1a1a1a",
    "container": "#2d2d2d",
    "codeBlock": "#1e1e1e",
    "text": "#e6e6e6",
    "border": "#404040",
    "badge": "#007acc"
  },
  "syntax": {
    "keyword": "#569cd6",
    "string": "#ce9178",
    "comment": "#6a9955",
    "number": "#b5cea8",
    "function": "#dcdcaa",
    "class": "#4ec9b0",
    "operator": "#d4d4d4",
    "punctuation": "#d4d4d4",
    "variable": "#9cdcfe",
    "property": "#9cdcfe"
  },
  "options": {
    "showTitle": true,
    "showLanguageBadge": true,
    "showWindowControls": true
  }
}
```

## Dependencies

### Runtime Dependencies
- **puppeteer**: Headless browser for screenshot generation
- **prismjs**: Syntax highlighting engine
- **fs-extra**: Enhanced file system operations

### Development Dependencies
- **typescript**: TypeScript compiler
- **@types/vscode**: VS Code API type definitions
- **eslint**: Code linting and style enforcement

## Build Process

### Compilation
```bash
npm run compile  # Compiles TypeScript and copies theme files
```

### File Operations
- TypeScript files compiled to `out/` directory
- Theme files copied from `src/themes/` to `out/themes/`
- Theme mapping file copied to maintain structure

## User Workflow

1. **Installation**: User installs extension in VS Code
2. **Code Selection**: User selects code in editor
3. **Command Execution**: User runs one of the two commands
4. **Configuration**: `.cirneco.json` created automatically if not exists
5. **Theme Processing**: Themes loaded and merged with user customizations
6. **HTML Generation**: Code converted to styled HTML with theme
7. **Screenshot**: Puppeteer captures image of rendered HTML
8. **Output**: PNG saved to `.cirneco/` folder in workspace

## Error Handling

### Common Issues
- **No active editor**: Shows error if no file is open
- **No code selected**: Prompts user to select code first
- **Theme loading errors**: Falls back to default theme
- **Screenshot failures**: Detailed error logging for debugging

### Debugging Features
- Console logging for theme loading and processing
- Configuration file validation and error reporting
- Puppeteer error handling with meaningful messages

## Recent Improvements

### Brand Integration
- Changed display name to "Cirne.co"
- Updated all user-facing messages with brand
- Added "cirne.co" to generated snippet watermark

### Configuration Standardization
- Changed config file from `cirneco.json` to `.cirneco.json`
- Follows standard dotfile convention (like `.eslintrc`, `.prettierrc`)

### Theme System Enhancements
- Individual theme files for better organization
- Theme merging system for customization
- Liquid Apple theme with glassmorphism effects

### Visual Improvements
- Fixed header styling to respect theme colors
- Improved window controls and title bar
- Enhanced branding with professional watermark

## Development Notes

### Code Organization
- Clean separation between extension logic and HTML generation
- Modular theme system with individual files
- Type-safe interfaces for themes and configuration

### Performance Considerations
- Efficient theme loading with caching
- Optimized Puppeteer settings for screenshot quality
- Dynamic viewport sizing based on content

### Future Extensibility
- Theme system designed for easy addition of new themes
- Configuration system supports new options without breaking changes
- Modular architecture allows for feature additions

## Testing & Quality Assurance

### Manual Testing
- Test both commands with various code samples
- Verify theme switching and customization
- Check configuration file creation and updates
- Validate screenshot quality and styling

### Error Scenarios
- Test with no workspace folder
- Test with invalid theme configurations
- Test with very large code blocks
- Test theme merging edge cases

This project demonstrates modern VS Code extension development with TypeScript, advanced theming systems, and professional UI/UX design.